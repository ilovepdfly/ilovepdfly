import{c as E,r as i,j as e,J as M,aJ as O,z as I,P,p as D,a1 as _,m as L,D as z}from"./main-DNTKgrdb.js";import{u as J,S as R}from"./useSignature-CsFLrdcS.js";import{r as T,u as C,a as V}from"./xlsx-eYdzo_tC.js";import"./react-Ckhrjn13.js";import"./html2canvas.esm-B0tyYwQk.js";const $=({className:p})=>e.jsx("div",{className:`p-2 bg-blue-600 rounded-md inline-block ${p}`,children:e.jsx("svg",{className:"h-6 w-6 text-white",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 00-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})})}),F=({isOpen:p,onClose:h,onAddContacts:f})=>{const[l,n]=i.useState([{name:"",email:"",phone:""}]),g=()=>{n([...l,{name:"",email:"",phone:""}])},u=(a,r,s)=>{const c=[...l];c[a][r]=s,n(c)},b=a=>{if(l.length>1){const r=l.filter((s,c)=>c!==a);n(r)}},j=()=>{f(l),m()},m=()=>{n([{name:"",email:"",phone:""}]),h()};return p?e.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",onClick:m,children:e.jsxs("div",{className:"bg-white dark:bg-black w-full max-w-xl rounded-lg shadow-xl",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Add Contact"}),e.jsx("button",{onClick:m,children:e.jsx(D,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[60vh] overflow-y-auto",children:[l.map((a,r)=>e.jsxs("div",{className:"grid sm:grid-cols-3 gap-4 items-center",children:[e.jsx("input",{type:"text",placeholder:"Name",value:a.name,onChange:s=>u(r,"name",s.target.value),className:"w-full p-2 border rounded-md bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600"}),e.jsx("input",{type:"email",placeholder:"Email",value:a.email,onChange:s=>u(r,"email",s.target.value),className:"w-full p-2 border rounded-md bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600"}),e.jsxs("div",{className:"relative flex items-center gap-2",children:[e.jsx(_,{className:"h-5 w-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none"}),e.jsx("input",{type:"tel",placeholder:"Phone",value:a.phone,onChange:s=>u(r,"phone",s.target.value),className:"w-full p-2 pl-10 border rounded-md bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600"}),l.length>1&&e.jsx("button",{onClick:()=>b(r),className:"p-1 text-gray-400 hover:text-red-500",children:e.jsx(I,{className:"h-4 w-4"})})]})]},r)),e.jsx("button",{onClick:g,className:"text-sm font-semibold text-brand-red hover:underline",children:"Add more"})]}),e.jsxs("div",{className:"flex justify-end gap-4 p-4 bg-gray-50 dark:bg-gray-900/50 rounded-b-lg",children:[e.jsx("button",{onClick:m,className:"px-6 py-2 text-sm font-semibold border rounded-md bg-white dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600",children:"Close"}),e.jsx("button",{onClick:j,className:"px-6 py-2 text-sm font-semibold text-white bg-brand-red rounded-md hover:bg-brand-red-dark",children:"Create"})]})]})}):null},B=({isOpen:p,onClose:h,onAddContacts:f})=>{const[l,n]=i.useState(""),g=()=>{const a=[["Name","Email","Phone"],["John Doe","john.doe@example.com","1234567890"],["Jane Smith","jane.smith@example.com","0987654321"]],r=C.aoa_to_sheet(a),s=C.book_new();C.book_append_sheet(s,r,"Contacts"),V(s,"sample_contacts.xlsx")},u=i.useCallback(a=>{n("");const r=a[0];if(r){const s=new FileReader;s.onload=c=>{try{const w=c.target?.result,y=T(w,{type:"binary"}),x=y.SheetNames[0],S=y.Sheets[x],v=C.sheet_to_json(S,{header:["name","email","phone"],range:1}).filter(k=>k.name&&k.email);if(v.length===0)throw new Error("No valid contacts found in the file.");f(v),h()}catch{n("Error parsing file. Please ensure it is a valid CSV or Excel file and matches the sample format.")}},s.readAsBinaryString(r)}},[f,h]),{getRootProps:b,getInputProps:j,open:m}=L({onDrop:u,noClick:!0,noKeyboard:!0,accept:{"text/csv":[".csv"],"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"text/vcard":[".vcf",".vcard"]}});return p?e.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",onClick:h,children:e.jsxs("div",{...b(),className:"bg-white dark:bg-black w-full max-w-md rounded-lg shadow-xl",onClick:a=>a.stopPropagation(),children:[e.jsx("input",{...j()}),e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Import contacts"}),e.jsx("button",{onClick:h,children:e.jsx(D,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-8 text-center space-y-4",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Import your contacts using CSV, Excel and VCard files"}),e.jsxs("button",{onClick:g,className:"text-brand-red font-semibold hover:underline flex items-center justify-center gap-2 mx-auto",children:[e.jsx(z,{className:"h-4 w-4"})," Download Excel sample"]}),l&&e.jsx("p",{className:"text-xs text-red-500",children:l}),e.jsx("button",{onClick:m,className:"w-full mt-4 bg-brand-red hover:bg-brand-red-dark text-white font-bold py-3 px-6 rounded-md transition-colors",children:"Import users"})]})]})}):null},U=()=>{const p=E(),{saveSignature:h}=J(),[f,l]=i.useState(!1),[n,g]=i.useState(()=>{try{const t=localStorage.getItem("ilovepdfly_contacts");return t?JSON.parse(t):[]}catch(t){return console.error("Could not load contacts from local storage",t),[]}}),[u,b]=i.useState(!1),[j,m]=i.useState(!1),[a,r]=i.useState(""),[s,c]=i.useState([]);i.useEffect(()=>{try{localStorage.setItem("ilovepdfly_contacts",JSON.stringify(n))}catch(t){console.error("Could not save contacts to local storage",t)}},[n]);const w=(t,o)=>{h(t,o),l(!1),p("/sign-pdf")},y=t=>{const o=t.filter(d=>d.name.trim()&&d.email.trim()).map((d,N)=>({...d,id:Date.now()+N}));g(d=>[...d,...o])},x=i.useMemo(()=>n.filter(t=>t.name.toLowerCase().includes(a.toLowerCase())||t.email.toLowerCase().includes(a.toLowerCase())),[n,a]),S=t=>{c(t.target.checked?x.map(o=>o.id):[])},A=t=>{c(o=>o.includes(t)?o.filter(d=>d!==t):[...o,t])},v=()=>{s.length>0&&window.confirm(`Are you sure you want to delete ${s.length} contact(s)?`)&&(g(t=>t.filter(o=>!s.includes(o.id))),c([]))},k=(t,o)=>{window.confirm(`Are you sure you want to delete the contact "${o}"?`)&&(g(d=>d.filter(N=>N.id!==t)),c(d=>d.filter(N=>N!==t)))};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full bg-white dark:bg-surface-dark rounded-lg shadow-lg border border-gray-200 dark:border-gray-800",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx($,{}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-7 w-auto"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:"Signature"})]})]}),e.jsx("button",{onClick:()=>l(!0),className:"w-full sm:w-auto bg-brand-red hover:bg-brand-red-dark text-white font-bold py-2 px-6 rounded-md",children:"New signature"})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:"Contacts"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>b(!0),className:"text-sm font-semibold text-brand-red hover:underline",children:"Add contact"}),e.jsx("button",{onClick:()=>m(!0),className:"text-sm font-semibold text-brand-red hover:underline",children:"Import contacts"})]})]}),e.jsxs("div",{className:"relative mb-6 max-w-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:e.jsx(O,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Name/Email",value:a,onChange:t=>r(t.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-md"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase bg-gray-50 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"p-4 w-12",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"checkbox",onChange:S,checked:n.length>0&&s.length===x.length,className:"h-4 w-4 rounded"}),s.length>0&&e.jsx("button",{onClick:v,title:"Delete selected contacts",children:e.jsx(I,{className:"h-5 w-5 text-gray-400 hover:text-red-500"})})]})}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Email"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Phone"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right",children:"Actions"})]})}),e.jsx("tbody",{children:x.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"py-8",children:e.jsxs("button",{onClick:()=>b(!0),className:"flex items-center justify-center gap-2 w-full text-brand-red font-semibold hover:opacity-80",children:[e.jsx(P,{className:"h-5 w-5"})," Add contact"]})})}):x.map(t=>e.jsxs("tr",{className:"border-b dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800/50",children:[e.jsx("td",{className:"p-4",children:e.jsx("input",{type:"checkbox",checked:s.includes(t.id),onChange:()=>A(t.id),className:"h-4 w-4 rounded"})}),e.jsx("td",{className:"px-6 py-4 font-semibold",children:t.name}),e.jsx("td",{className:"px-6 py-4",children:t.email}),e.jsx("td",{className:"px-6 py-4",children:t.phone}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("button",{onClick:()=>k(t.id,t.name),title:`Delete ${t.name}`,className:"p-2 text-gray-400 hover:text-red-500 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:e.jsx(I,{className:"h-5 w-5"})})})]},t.id))})]})}),e.jsxs("div",{className:"mt-4 text-xs text-gray-500 dark:text-gray-400",children:["1-",x.length," of ",x.length]})]})]}),e.jsx(R,{isOpen:f,onClose:()=>l(!1),onSave:w}),e.jsx(F,{isOpen:u,onClose:()=>b(!1),onAddContacts:y}),e.jsx(B,{isOpen:j,onClose:()=>m(!1),onAddContacts:y})]})};export{U as default};
