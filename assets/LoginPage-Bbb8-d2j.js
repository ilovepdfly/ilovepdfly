import{r as a,s as Q,q as X,b as Z,j as e,L as ee}from"./main-Co0eRREc.js";const re=()=>{const[i,z]=a.useState("email"),[N,S]=a.useState(""),[O,P]=a.useState(""),[o,I]=a.useState(""),[c,u]=a.useState(new Array(6).fill("")),[g,x]=a.useState("enter-phone"),[L,C]=a.useState(null),[T,n]=a.useState(""),[m,d]=a.useState(!1),[b,p]=a.useState(!1),[y,v]=a.useState(null),[l,w]=a.useState(0),{login:$,loginOrSignupWithGoogle:M,sendLoginOtp:D,verifyLoginOtp:B,displayedOtp:E}=Q(),j=X(),h=Z(),f=a.useRef([]),G=h.state?.from==="pricing",U=h.state?.from==="/invoice-generator",R=h.state?.plan;a.useEffect(()=>{document.title="Login | I Love PDFLY";const t=document.querySelector('meta[name="description"]');t&&t.setAttribute("content","Sign in to your I Love PDFLY account to access all your tools and premium features. Manage your documents easily and securely.")},[]),a.useEffect(()=>{let t;return l>0&&(t=setInterval(()=>{w(r=>r-1)},1e3)),()=>clearInterval(t)},[l]);const k=()=>{const t=localStorage.getItem("pendingInvoiceData");U&&t?(localStorage.removeItem("pendingInvoiceData"),j("/invoice-generator",{state:{restoredData:JSON.parse(t)},replace:!0})):G?j("/payment",{state:{plan:R}}):j("/")},Y=async t=>{t.preventDefault(),n(""),d(!0);try{await $(N,O),k()}catch(r){n(r.message||"Failed to log in. Please check your credentials.")}finally{d(!1)}},F=t=>{v({message:t,visible:!0}),setTimeout(()=>{v(r=>r?{...r,visible:!1}:null),setTimeout(()=>v(null),500)},4500)},K=async()=>{if(!(l>0)){p(!0),n("");try{const t=await D(o);C(t),F(`A new OTP has been sent to ${o}.`),w(30)}catch(t){n(t.message)}finally{p(!1)}}},V=async t=>{if(t.preventDefault(),n(""),g==="enter-phone"){p(!0);try{const r=await D(o);C(r),F(`An OTP has been sent to ${o}.`),x("enter-otp"),w(30)}catch(r){n(r.message)}finally{p(!1)}}else{const r=c.join("");if(r.length!==6){n("Please enter the complete 6-digit OTP.");return}if(!L){n("Something went wrong. Please try sending the OTP again.");return}d(!0);try{await B(L,r),k()}catch(s){n(s.message)}finally{d(!1)}}},_=async()=>{n(""),d(!0);try{await M(),k()}catch(t){n(t.message||"Failed to sign in with Google.")}finally{d(!1)}};a.useEffect(()=>{window.google&&(window.google.accounts.id.initialize({client_id:"974035582208-leq5h6cbrjr4n6q78pagt7br7piuvoep.apps.googleusercontent.com",callback:_}),window.google.accounts.id.renderButton(document.getElementById("google-login-button"),{theme:"outline",size:"large",type:"standard",text:"signin_with",width:"300"}))},[]);const q=t=>{z(t),n(""),S(""),P(""),I(""),u(new Array(6).fill("")),x("enter-phone")},J=(t,r)=>{const{value:s}=t.target;if(isNaN(Number(s)))return;const A=[...c];A[r]=s,u(A),s&&r<5&&f.current[r+1]?.focus()},W=(t,r)=>{t.key==="Backspace"&&!c[r]&&r>0&&f.current[r-1]?.focus()},H=t=>{const r=t.clipboardData.getData("text");if(/^\d{6}$/.test(r)){const s=r.split("");u(s),f.current[5]?.focus()}};return e.jsxs(e.Fragment,{children:[y&&e.jsxs("div",{className:`fixed top-5 right-5 z-[200] p-4 rounded-lg shadow-lg text-white transition-all duration-500 ${y.visible?"opacity-100 translate-x-0":"opacity-0 translate-x-full"} bg-green-500`,children:[e.jsx("p",{className:"font-bold",children:"OTP Sent!"}),e.jsx("p",{className:"text-sm",children:y.message})]}),e.jsx("div",{className:"min-h-[calc(100vh-200px)] flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 bg-gray-50 dark:bg-black",children:e.jsxs("div",{className:"w-full max-w-md space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"mt-6 text-center text-3xl font-bold tracking-tight text-gray-900 dark:text-white",children:"Sign in to your account"}),e.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600 dark:text-gray-400",children:["Or"," ",e.jsx(ee,{to:"/signup",state:{from:h.state?.from,plan:R},className:"font-medium text-brand-red hover:text-brand-red-dark",children:"create a new account"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-800 p-8 rounded-lg shadow-lg animated-border",children:[T&&e.jsx("p",{className:"text-center text-sm text-red-500 bg-red-100 dark:bg-red-900/30 p-3 rounded-md mb-4",children:T}),e.jsxs("div",{className:"flex border-b border-gray-300 dark:border-gray-700 mb-6",children:[e.jsx("button",{type:"button",onClick:()=>q("email"),className:`flex-1 py-2 font-semibold transition-colors ${i==="email"?"text-brand-red border-b-2 border-brand-red":"text-gray-500 dark:text-gray-400"}`,children:"Email / Username"}),e.jsx("button",{type:"button",onClick:()=>q("phone"),className:`flex-1 py-2 font-semibold transition-colors ${i==="phone"?"text-brand-red border-b-2 border-brand-red":"text-gray-500 dark:text-gray-400"}`,children:"Phone Number"})]}),i==="email"&&e.jsxs("form",{className:"space-y-6",onSubmit:Y,children:[e.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"identifier",className:"sr-only",children:"Username or Email"}),e.jsx("input",{id:"identifier",name:"identifier",type:"text",autoComplete:"username",required:!0,value:N,onChange:t=>S(t.target.value),className:"relative block w-full appearance-none rounded-none rounded-t-md border border-gray-300 dark:border-gray-700 px-3 py-2 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 bg-white dark:bg-black focus:z-10 focus:border-brand-red focus:outline-none focus:ring-brand-red sm:text-sm",placeholder:"Username or Email"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),e.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:O,onChange:t=>P(t.target.value),className:"relative block w-full appearance-none rounded-none rounded-b-md border border-gray-300 dark:border-gray-700 px-3 py-2 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 bg-white dark:bg-black focus:z-10 focus:border-brand-red focus:outline-none focus:ring-brand-red sm:text-sm",placeholder:"Password"})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:m,className:"group relative flex w-full justify-center rounded-md border border-transparent bg-brand-red py-2 px-4 text-sm font-medium text-white hover:bg-brand-red-dark focus:outline-none focus:ring-2 focus:ring-brand-red-dark focus:ring-offset-2 disabled:bg-red-300 dark:disabled:bg-red-800 transition-colors",children:m?"Signing in...":"Sign In"})})]}),i==="phone"&&e.jsxs("form",{className:"space-y-6",onSubmit:V,children:[g==="enter-phone"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone-number",className:"sr-only",children:"Phone Number"}),e.jsx("input",{id:"phone-number",name:"phone-number",type:"tel",autoComplete:"tel",required:!0,value:o,onChange:t=>I(t.target.value),className:"relative block w-full appearance-none rounded-md border border-gray-300 dark:border-gray-700 px-3 py-2 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 bg-white dark:bg-black focus:z-10 focus:border-brand-red focus:outline-none focus:ring-brand-red sm:text-sm",placeholder:"Enter phone (e.g., +16505551234)"})]}),g==="enter-otp"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-center text-sm text-gray-600 dark:text-gray-400",children:["Enter the 6-digit code sent to ",o,".",e.jsx("button",{type:"button",onClick:()=>{x("enter-phone"),n(""),u(new Array(6).fill(""))},className:"font-medium text-brand-red hover:underline ml-1",children:"Change"})]}),e.jsx("div",{className:"flex justify-center gap-2",onPaste:H,children:c.map((t,r)=>e.jsx("input",{type:"text",maxLength:1,value:t,onChange:s=>J(s,r),onKeyDown:s=>W(s,r),ref:s=>{f.current[r]=s},className:"w-10 h-12 text-center text-lg font-semibold border border-gray-300 dark:border-gray-600 rounded-md focus:border-brand-red focus:ring-1 focus:ring-brand-red bg-white dark:bg-black"},r))}),E&&e.jsx("div",{className:"mt-4 p-3 bg-yellow-100 dark:bg-yellow-900/50 border-l-4 border-yellow-400 text-yellow-800 dark:text-yellow-300 rounded-md text-sm",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Demo Only:"})," Your verification code is ",e.jsx("strong",{className:"font-mono",children:E})]})}),e.jsx("div",{className:"text-center text-sm",children:l>0?e.jsxs("p",{className:"text-gray-500",children:["Resend OTP in ",l,"s"]}):e.jsx("button",{type:"button",onClick:K,disabled:b,className:"font-medium text-brand-red hover:underline disabled:text-gray-500",children:b?"Sending...":"Resend OTP"})})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:m||b,className:"group relative flex w-full justify-center rounded-md border border-transparent bg-brand-red py-2 px-4 text-sm font-medium text-white hover:bg-brand-red-dark focus:outline-none focus:ring-2 focus:ring-brand-red-dark focus:ring-offset-2 disabled:bg-red-300 dark:disabled:bg-red-800 transition-colors",children:b?"Sending OTP...":m?"Verifying...":g==="enter-phone"?"Send OTP":"Verify & Sign In"})})]}),e.jsxs("div",{className:"relative my-6",children:[e.jsx("div",{className:"absolute inset-0 flex items-center","aria-hidden":"true",children:e.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-700"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"bg-white dark:bg-black px-2 text-gray-500 dark:text-gray-400",children:"OR"})})]}),e.jsx("div",{id:"google-login-button",className:"flex justify-center"})]})]})})]})};export{re as default};
