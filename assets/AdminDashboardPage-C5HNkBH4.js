import{u as P,r as l,j as e,N as A,S,ac as C,h as D,a8 as I}from"./main--FR5vwUm.js";const L=()=>{const{getAllUsers:y,updateUserPremiumStatus:u,updateUserApiPlan:b,logout:j,deleteUser:f}=P(),[t,n]=l.useState([]),[c,m]=l.useState(!0),[h,w]=l.useState(""),[i,N]=l.useState(""),[o,d]=l.useState(null),x=async()=>{m(!0);try{const a=await y();n(a)}catch{w("Failed to load user data.")}finally{m(!1)}};l.useEffect(()=>{x()},[]);const v=async(a,s)=>{d(a);try{await u(a,!s),n(t.map(r=>r.uid===a?{...r,isPremium:!s}:r))}catch{alert(`Failed to update status for user ${a}.`)}finally{d(null)}},k=async(a,s)=>{d(a);try{await b(a,s),n(t.map(r=>r.uid===a?{...r,apiPlan:s}:r))}catch{alert(`Failed to update API plan for user ${a}.`)}finally{d(null)}},U=async(a,s)=>{if(window.confirm(`Are you sure you want to delete user "${s}"? This will only remove their data record.`)){d(a);try{await f(a),await x()}catch(r){alert(`Error deleting user: ${r.message}`)}finally{d(null)}}},p=l.useMemo(()=>t.filter(a=>a.username.toLowerCase().includes(i.toLowerCase())),[t,i]),g=l.useMemo(()=>({totalUsers:t.length,premiumUsers:t.filter(a=>a.isPremium).length,apiUsers:t.filter(a=>a.apiPlan&&a.apiPlan!=="free").length}),[t]);return e.jsx("div",{className:"py-16 md:py-24 bg-gray-50 dark:bg-black",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center mb-8 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-extrabold text-gray-800 dark:text-gray-100",children:"Admin Dashboard"}),e.jsx("p",{className:"mt-2 text-gray-500 dark:text-gray-400",children:"Manage users and monitor site activity."})]}),e.jsx("button",{onClick:j,className:"bg-red-500 text-white font-bold py-2 px-4 rounded-md hover:bg-red-600 transition-colors self-start sm:self-center",children:"Logout"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-900 p-6 rounded-lg shadow-md flex items-center gap-4 border-l-4 border-blue-500",children:[e.jsx(A,{className:"h-10 w-10 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Users"}),e.jsx("p",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:g.totalUsers})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-900 p-6 rounded-lg shadow-md flex items-center gap-4 border-l-4 border-yellow-500",children:[e.jsx(S,{className:"h-10 w-10 text-yellow-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Premium Users"}),e.jsx("p",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:g.premiumUsers})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-900 p-6 rounded-lg shadow-md flex items-center gap-4 border-l-4 border-purple-500",children:[e.jsx(C,{className:"h-10 w-10 text-purple-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Active API Users"}),e.jsx("p",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:g.apiUsers})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl overflow-hidden animated-border",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex flex-col sm:flex-row gap-4 items-center",children:[e.jsx("input",{type:"text",placeholder:"Search by username...",value:i,onChange:a=>N(a.target.value),className:"w-full sm:w-auto flex-grow px-4 py-2 bg-gray-100 dark:bg-gray-800 border border-transparent rounded-md focus:ring-brand-red focus:border-brand-red text-gray-800 dark:text-gray-200"}),e.jsxs("button",{onClick:x,disabled:c,className:"flex items-center gap-2 text-sm font-semibold bg-gray-200 dark:bg-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:[e.jsx(D,{className:`h-4 w-4 ${c?"animate-spin":""}`})," Refresh"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left text-gray-500 dark:text-gray-400",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-800 dark:text-gray-400",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Username"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Premium Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"API Plan"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Joined Date"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-center",children:"Actions"})]})}),e.jsx("tbody",{children:c?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center p-6",children:"Loading users..."})}):h?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center p-6 text-red-500",children:h})}):p.length>0?p.map(a=>e.jsxs("tr",{className:`border-b dark:border-gray-700 transition-colors ${a.isPremium?"bg-yellow-50 dark:bg-yellow-900/10":"bg-white dark:bg-gray-900"} hover:bg-gray-50 dark:hover:bg-gray-800/50`,children:[e.jsxs("th",{scope:"row",className:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white",children:[o===a.uid&&e.jsxs("svg",{className:"animate-spin h-4 w-4 inline mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),a.username]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("button",{onClick:()=>v(a.uid,a.isPremium),disabled:o===a.uid,className:`px-3 py-1 text-xs font-semibold rounded-full transition-colors ${a.isPremium?"bg-green-500 text-white hover:bg-green-600":"bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300"}`,children:a.isPremium?"Active":"Activate"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("select",{value:a.apiPlan||"free",disabled:o===a.uid,onChange:s=>k(a.uid,s.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 text-xs rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-1.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",children:[e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"developer",children:"Developer"}),e.jsx("option",{value:"business",children:"Business"})]})}),e.jsx("td",{className:"px-6 py-4",children:a.creationDate?new Date(a.creationDate).toLocaleDateString():"N/A"}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("button",{onClick:()=>U(a.uid,a.username),disabled:o===a.uid,title:"Delete User",className:"p-2 text-gray-400 hover:text-red-500 rounded-full hover:bg-red-100 dark:hover:bg-red-900/50 transition-colors",children:e.jsx(I,{className:"h-5 w-5"})})})]},a.uid)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center p-6",children:"No users found."})})})]})})]})]})})})};export{L as default};
